import{r as c,j as a}from"./vendor-DNlhI76F.js";import{b as _}from"./pages-main-DOjN59On.js";import"./query-D71mr71Q.js";import"./icons-B2XESxUM.js";import"./utils-Bj7X0qp-.js";import"./radix-z-2eheXi.js";function I(){const[o,u]=c.useState([]),[i,l]=c.useState(!1),[h,d]=c.useState(null),[b,y]=c.useState("stripe"),[s,r]=c.useState({name:""}),[,p]=_(),m=async()=>{try{l(!0),d(null);const e=await(await fetch("/api/payments/gateways")).json();u(e.accounts||[])}catch(t){d((t==null?void 0:t.message)||"Failed to load accounts")}finally{l(!1)}};c.useEffect(()=>{m()},[]);const j=async t=>{t.preventDefault();try{l(!0),d(null);const e={gateway:b,...s},x=await fetch("/api/payments/gateways",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),f=await x.json();if(!x.ok)throw new Error(f.error||"Failed to add account");r({name:""}),await m()}catch(e){d((e==null?void 0:e.message)||"Failed to add account")}finally{l(!1)}},v=async t=>{try{l(!0),d(null);const e=await fetch(`/api/payments/gateways/${t}/activate`,{method:"PUT"}),x=await e.json();if(!e.ok)throw new Error(x.error||"Failed to activate account");await m()}catch(e){d((e==null?void 0:e.message)||"Failed to activate")}finally{l(!1)}},g=c.useMemo(()=>({stripe:o.filter(t=>t.gateway==="stripe"),razorpay:o.filter(t=>t.gateway==="razorpay"),bank:o.filter(t=>t.gateway==="bank")}),[o]),k=()=>b==="stripe"?a.jsxs(a.Fragment,{children:[a.jsx(n,{label:"Account Name",value:s.name||"",onChange:t=>r(e=>({...e,name:t}))}),a.jsx(n,{label:"Publishable Key",value:s.publishable_key||"",onChange:t=>r(e=>({...e,publishable_key:t}))}),a.jsx(n,{label:"Secret Key",value:s.secret_key||"",onChange:t=>r(e=>({...e,secret_key:t}))}),a.jsx(n,{label:"Webhook Secret",value:s.webhook_secret||"",onChange:t=>r(e=>({...e,webhook_secret:t}))})]}):b==="razorpay"?a.jsxs(a.Fragment,{children:[a.jsx(n,{label:"Account Name",value:s.name||"",onChange:t=>r(e=>({...e,name:t}))}),a.jsx(n,{label:"Key ID",value:s.publishable_key||"",onChange:t=>r(e=>({...e,publishable_key:t}))}),a.jsx(n,{label:"Key Secret",value:s.secret_key||"",onChange:t=>r(e=>({...e,secret_key:t}))}),a.jsx(n,{label:"Webhook Secret",value:s.webhook_secret||"",onChange:t=>r(e=>({...e,webhook_secret:t}))})]}):a.jsxs(a.Fragment,{children:[a.jsx(n,{label:"Account Name",value:s.name||"",onChange:t=>r(e=>({...e,name:t}))}),a.jsx(n,{label:"Bank Account Holder",value:s.bank_account_holder||"",onChange:t=>r(e=>({...e,bank_account_holder:t}))}),a.jsx(n,{label:"Bank & Branch",value:s.bank_name_branch||"",onChange:t=>r(e=>({...e,bank_name_branch:t}))}),a.jsx(n,{label:"Account Number",value:s.bank_account_number||"",onChange:t=>r(e=>({...e,bank_account_number:t}))}),a.jsx(n,{label:"IFSC",value:s.bank_ifsc||"",onChange:t=>r(e=>({...e,bank_ifsc:t}))}),a.jsx(n,{label:"UPI VPA",value:s.upi_vpa||"",onChange:t=>r(e=>({...e,upi_vpa:t}))}),a.jsx(n,{label:"UPI QR URL",value:s.upi_qr_url||"",onChange:t=>r(e=>({...e,upi_qr_url:t}))}),a.jsx(N,{label:"Instructions",value:s.instructions||"",onChange:t=>r(e=>({...e,instructions:t}))})]});return a.jsxs("div",{className:"max-w-5xl mx-auto p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Admin Payments"}),a.jsx("button",{onClick:()=>p("/admin"),className:"px-3 py-2 text-sm rounded bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700 hover:bg-gray-300 dark:hover:bg-gray-700",children:"Back to Admin"})]}),h&&a.jsx("div",{className:"mb-4 p-3 rounded bg-red-50 text-red-700 text-sm",children:h}),a.jsxs("section",{className:"mb-8 border rounded p-4",children:[a.jsx("h2",{className:"text-lg font-medium mb-4",children:"Add Payment Account"}),a.jsxs("form",{onSubmit:j,className:"space-y-3",children:[a.jsx("div",{className:"flex gap-3",children:["stripe","razorpay","bank"].map(t=>a.jsx("button",{type:"button",onClick:()=>y(t),className:`px-3 py-2 rounded text-sm ${b===t?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700"}`,children:t.toUpperCase()},t))}),k(),a.jsx("div",{children:a.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:!!s.is_active,onChange:t=>r(e=>({...e,is_active:t.target.checked}))}),"Set as active"]})}),a.jsx("button",{disabled:i,className:"px-4 py-2 rounded bg-blue-600 text-white",children:i?"Saving...":"Save Account"})]})]}),a.jsx("section",{className:"grid md:grid-cols-3 gap-6",children:["stripe","razorpay","bank"].map(t=>a.jsxs("div",{className:"border rounded p-4",children:[a.jsxs("h3",{className:"font-semibold mb-3",children:[t.toUpperCase()," Accounts"]}),a.jsxs("div",{className:"space-y-3",children:[g[t].length===0&&a.jsx("div",{className:"text-sm text-gray-500",children:"No accounts added."}),g[t].map(e=>a.jsxs("div",{className:`border rounded p-3 ${e.is_active?"border-green-500":"border-gray-200"}`,children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:e.name||`Account #${e.id}`}),a.jsx("div",{className:"text-xs text-gray-500",children:e.is_active?"Active":"Inactive"})]}),!e.is_active&&a.jsx("button",{onClick:()=>v(e.id),className:"text-sm px-3 py-1 rounded bg-green-600 text-white",children:"Activate"})]}),t!=="bank"?a.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[a.jsxs("div",{children:["Publishable/Key ID: ",e.publishable_key||"-"]}),a.jsxs("div",{children:["Secret Key: ",e.secret_key?"••••••":"-"]}),e.webhook_secret&&a.jsx("div",{children:"Webhook: ••••••"})]}):a.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[a.jsxs("div",{children:["Holder: ",e.bank_account_holder||"-"]}),a.jsxs("div",{children:["Bank & Branch: ",e.bank_name_branch||"-"]}),a.jsxs("div",{children:["Account: ",e.bank_account_number||"-"]}),a.jsxs("div",{children:["IFSC: ",e.bank_ifsc||"-"]}),a.jsxs("div",{children:["UPI: ",e.upi_vpa||"-"]})]})]},e.id))]})]},t))})]})}function n({label:o,value:u,onChange:i}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm mb-1",children:o}),a.jsx("input",{className:"w-full border rounded px-3 py-2 text-sm bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 placeholder:text-gray-600 dark:placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:u,onChange:l=>i(l.target.value)})]})}function N({label:o,value:u,onChange:i}){return a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm mb-1",children:o}),a.jsx("textarea",{className:"w-full border rounded px-3 py-2 text-sm bg-gray-100 dark:bg-gray-800 border-gray-300 dark:border-gray-700 placeholder:text-gray-600 dark:placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:u,onChange:l=>i(l.target.value)})]})}export{I as default};
