import{r as a,j as t}from"./vendor-DNlhI76F.js";import{a as D,u as U}from"./query-D71mr71Q.js";import{b as G,u as M,i as k,U as T,A as L,P as K,W as C,d as F,B as O,l as $,e as H,j as W}from"./pages-main-DOjN59On.js";import{S as q,a as Y,b as Z,c as z,P as Q}from"./pages-picks-B8mK09nr.js";import"./icons-B2XESxUM.js";import"./utils-Bj7X0qp-.js";import"./radix-z-2eheXi.js";const E={USD_INR:83.12,EUR_INR:89.45,GBP_INR:104.23,INR_USD:.012,INR_EUR:.011,INR_GBP:.0096,USD_EUR:.92,USD_GBP:.79,EUR_USD:1.09,EUR_GBP:.86,GBP_USD:1.27,GBP_EUR:1.16,JPY_INR:.56,CAD_INR:61.45,AUD_INR:54.23,CHF_INR:91.78,CNY_INR:11.45,SEK_INR:7.89,NZD_INR:50.12,MXN_INR:4.78,SGD_INR:61.23,HKD_INR:10.67,NOK_INR:7.56,TRY_INR:2.78,ZAR_INR:4.45,BRL_INR:16.78,RUB_INR:.89,KRW_INR:.063,THB_INR:2.34,PLN_INR:20.45,CZK_INR:3.67,HUF_INR:.23,ILS_INR:22.78,CLP_INR:.089,PHP_INR:1.48,AED_INR:22.61,COP_INR:.021,SAR_INR:22.15,MYR_INR:17.89,RON_INR:18.23},V=(d,o,s)=>{if(o===s)return d;const r=`${o}_${s}`,l=E[r];if(l)return d*l;const i=`${s}_${o}`,n=E[i];return n?d/n:(console.warn(`No exchange rate found for ${o} to ${s}`),d)},J=(d,o,s,r,l)=>{if(r==="all")return!0;const i=parseFloat(d.toString().replace(/[^0-9.]/g,""));let n=i;l&&s!=="all"&&o!==s&&(n=V(i,o,s));const[g,u]=r.split("-").map(Number);return u?n>=g&&n<=u:n>=g};function fe(){const[d,o]=a.useState({}),[s,r]=a.useState(""),[l,i]=a.useState("all"),[n,g]=a.useState(!1),[u,f]=a.useState("all"),[P,p]=a.useState(0),[R,S]=a.useState("all");G(),D();const[X,A]=a.useState(!1),[ee,te]=a.useState(!1),[se,ae]=a.useState([]),[ne,re]=a.useState(!1),[ie,oe]=a.useState(null),[B,j]=a.useState(!1);M(),a.useEffect(()=>{const e=localStorage.getItem("pickntrust-admin-session");A(e==="active")},[]);const{data:h,isLoading:y,error:le}=U({queryKey:["/api/products/page/trending",s],queryFn:async()=>{const e=s?`/api/products/page/trending?category=${encodeURIComponent(s)}`:"/api/products/page/trending",c=await fetch(e);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);return c.json()},staleTime:5*60*1e3,refetchOnWindowFocus:!1}),x=(h||[]).filter(e=>{typeof e.price=="string"?parseFloat(e.price):e.price;const c=typeof e.rating=="string"?parseFloat(e.rating):e.rating||0,m=!s||e.category===s,N=J(e.price||0,e.currency||"INR",l,u,n),_=c>=P,I=k(e);return m&&N&&_&&(R==="all"||(R==="kids"?I==="kids"||I==="boys"||I==="girls":I===R))}),{data:w=[]}=U({queryKey:["/api/categories/page/trending"],queryFn:async()=>{const e=await fetch("/api/categories/page/trending");if(!e.ok){if(e.status===404)return[];throw new Error("Failed to fetch categories")}return e.json()},staleTime:0}),v=a.useMemo(()=>{const e=Array.from(new Set((h||[]).map(m=>m.category).filter(m=>!!m))),c=new Set([...w,...e]);return Array.from(c)},[w,h]),b=a.useMemo(()=>{const e=new Set;return(h||[]).forEach(N=>{const _=k(N);_&&e.add(_)}),(e.has("boys")||e.has("girls"))&&!e.has("kids")&&e.add("kids"),["all",...["men","women","kids","boys","girls","unisex"].filter(N=>e.has(N))]},[h]);return t.jsxs(T,{pageId:"trending",title:"Trending Products",children:[t.jsx(L,{page:"trending"}),t.jsx(K,{pageSlug:"trending"}),t.jsx(C,{page:"trending",position:"header-bottom",className:"w-full"}),t.jsx("div",{className:"header-spacing",children:t.jsxs("div",{className:"flex min-h-screen bg-gray-50 dark:bg-gray-900",children:[t.jsx("div",{className:"hidden md:block",children:t.jsx(F,{showNetworks:!1,categorySelectionMode:"single",selectedCurrency:l,setSelectedCurrency:i,convertPrices:n,setConvertPrices:g,priceRange:u,setPriceRange:f,availableCategories:v,selectedCategory:s,setSelectedCategory:r,availableGenders:b,selectedGender:R,setSelectedGender:S,minRating:P,setMinRating:p,resultsCount:x.length,onClearFilters:()=>{r(""),i("all"),g(!1),f("all"),S("all"),p(0)}})}),t.jsxs("div",{className:"flex-1 p-6",children:[t.jsxs("div",{className:"md:hidden flex items-center justify-between mt-1 mb-4",children:[t.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Explore what's trending"}),t.jsxs(O,{variant:"outline",size:"sm",onClick:()=>j(!0),children:[t.jsx("i",{className:"fas fa-filter mr-2"})," Filters"]})]}),y&&t.jsx("div",{className:"py-10 text-center text-gray-400",children:"Loading trending products..."}),!y&&x.length===0&&t.jsx("div",{className:"py-10 text-center",children:t.jsx("div",{className:"text-gray-300",children:"No trending products yet. Check back soon!"})}),t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4",children:x.map(e=>t.jsx("div",{className:"",children:t.jsx($,{product:e})},e.id))})]})]})}),t.jsx(q,{open:B,onOpenChange:j,children:t.jsxs(Y,{side:"left",className:"w-[85vw] sm:w-[22rem]",children:[t.jsx(Z,{children:t.jsx(z,{children:"Filters"})}),t.jsx("div",{className:"mt-4",children:t.jsx(F,{showNetworks:!1,categorySelectionMode:"single",selectedCurrency:l,setSelectedCurrency:i,convertPrices:n,setConvertPrices:g,priceRange:u,setPriceRange:f,availableCategories:v,selectedCategory:s,setSelectedCategory:r,availableGenders:b,selectedGender:R,setSelectedGender:S,minRating:P,setMinRating:p,resultsCount:x.length,onClearFilters:()=>{r(""),i("all"),g(!1),f("all"),S("all"),p(0)}})})]})}),t.jsx(C,{page:"trending",position:"content-bottom"}),t.jsx(H,{page:"trending",position:"floating-bottom-right"}),t.jsx(Q,{page:"trending",title:"Trending Videos"}),t.jsx(W,{})]})}export{fe as default};
