import{j as e}from"./query-COiO4MCT.js";import{r}from"./vendor-1XCZ5AD1.js";import{U as ie,B as i,C as u,t as v,v as y,o as w,p as b}from"./pages-main-DHSVTjK5.js";import{S as z}from"./switch-BpB8f5xD.js";import{L as h,S as C,a as T,b as S,c as k,d,I as g}from"./pages-travel-68kSWt82.js";import{R as A,$ as le,P as re,m as ne,T as ce,z as E,i as L,ap as oe,ab as de,D as me}from"./icons-CGpN3lH8.js";import"./radix-mRa0f3kV.js";import"./utils-Bj7X0qp-.js";import"./pages-picks-myehRy1v.js";const we=()=>{const[U,j]=r.useState([]),[x,$]=r.useState(null),[D,O]=r.useState(!0),[P,V]=r.useState(null),[f,R]=r.useState(""),[xe,M]=r.useState(null),[l,m]=r.useState({networkName:"",affiliateTag:"",tagType:"parameter",commissionRate:0}),[F,N]=r.useState(null),[H,B]=r.useState(null),[J,I]=r.useState(null),o=async()=>{try{const t=await(await fetch("/api/admin/bots/status")).json();t.success&&(j(t.data.bots),$(t.data.overview),await p())}catch(s){console.error("Error fetching bot status:",s)}finally{O(!1)}},p=async()=>{try{const s=await fetch("/api/admin/bots/affiliate-tags");if(s.ok){const t=await s.json();j(a=>a.map(n=>({...n,affiliateTags:t.filter(c=>c.botName===n.botName)})))}}catch(s){console.error("Failed to fetch affiliate tags:",s)}},K=async s=>{try{(await fetch("/api/admin/bots/affiliate-tags",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({botName:s,...l})})).ok&&(await p(),m({networkName:"",affiliateTag:"",tagType:"parameter",commissionRate:0}),N(null))}catch(t){console.error("Failed to add affiliate tag:",t)}},q=async s=>{try{(await fetch(`/api/admin/bots/affiliate-tags/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok&&(await p(),M(null))}catch(t){console.error("Failed to update affiliate tag:",t)}},W=async s=>{try{(await fetch(`/api/admin/bots/affiliate-tags/${s}`,{method:"DELETE"})).ok&&await p()}catch(t){console.error("Failed to delete affiliate tag:",t)}},G=async s=>{await q({...s,isActive:!s.isActive})},X=async(s,t)=>{try{(await fetch(`/api/admin/bots/${s}/commission-method`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({method:t})})).ok&&j(n=>n.map(c=>c.botName===s?{...c,commissionRateMethod:t}:c))}catch(a){console.error("Failed to update commission rate method:",a)}},Q=async(s,t)=>{try{I(s);const a=new FormData;a.append("csvFile",t),a.append("botName",s);const n=await fetch("/api/admin/bots/commission-rates/upload",{method:"POST",body:a});if(n.ok){const c=await n.json();console.log(`Uploaded ${c.count} commission rates for ${s}`),await o()}}catch(a){console.error("Failed to upload CSV:",a)}finally{I(null)}},Y=async(s,t)=>{try{(await fetch(`/api/admin/bots/${s}/toggle`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:t})})).ok&&o()}catch(a){console.error("Error toggling bot:",a)}},Z=async s=>{try{(await fetch(`/api/admin/bots/${s}/restart`,{method:"POST"})).ok&&o()}catch(t){console.error("Error restarting bot:",t)}},_=async(s,t)=>{try{(await fetch(`/api/admin/bots/${s}/method`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({method:t})})).ok&&o()}catch(a){console.error("Error updating bot method:",a)}},ee=async s=>{if(f)try{(await fetch(`/api/admin/bots/${s}/api`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({apiKey:f})})).ok&&(R(""),o())}catch(t){console.error("Error enabling API:",t)}},se=async()=>{try{(await fetch("/api/admin/bots/initialize",{method:"POST"})).ok&&o()}catch(s){console.error("Error initializing bots:",s)}};r.useEffect(()=>{o();const s=setInterval(o,3e4);return()=>clearInterval(s)},[]);const ae=s=>{switch(s){case"active":return e.jsx(me,{className:"h-4 w-4 text-green-500"});case"inactive":return e.jsx(L,{className:"h-4 w-4 text-gray-500"});case"error":return e.jsx(de,{className:"h-4 w-4 text-red-500"});case"conflict":return e.jsx(oe,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(L,{className:"h-4 w-4 text-gray-500"})}},te=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"error":return"bg-red-100 text-red-800";case"conflict":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}};return D?e.jsxs("div",{className:"flex items-center justify-center min-h-screen",children:[e.jsx(A,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading bot status..."})]}):e.jsx(ie,{pageId:"botadmin",children:e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"8-Bot System Admin Panel"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(i,{variant:"outline",onClick:()=>{window.location.href="/"},className:"flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-home"})," Home"]}),e.jsx(i,{variant:"outline",onClick:()=>{window.location.href="/admin"},className:"flex items-center gap-2",children:"ðŸŽ›ï¸ Admin Panel"})]})]}),e.jsxs(i,{onClick:se,className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Initialize All Bots"]})]}),x&&e.jsxs(u,{children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"h-5 w-5"}),"System Health"]})}),e.jsx(w,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.totalBots}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Bots"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:x.activeBots}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Bots"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:x.errorBots}),e.jsx("div",{className:"text-sm text-gray-600",children:"Error Bots"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[x.healthPercentage,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Health Score"})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:U.map(s=>{var t;return e.jsxs(u,{className:"relative",children:[e.jsx(v,{children:e.jsxs(y,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[ae(s.status),e.jsx("span",{className:"text-lg",children:s.displayName})]}),e.jsx(b,{className:te(s.status),children:s.status.toUpperCase()})]})}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Network:"})," ",s.affiliateNetwork]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Table:"})," ",s.tableName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Method:"})," ",s.currentMethod]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Available:"})," ",s.methodsAvailable.join(", ")]})]}),e.jsxs("div",{className:"bg-slate-800 text-white p-3 rounded-lg border",children:[e.jsx("div",{className:"text-sm font-medium mb-2 text-slate-200",children:"Performance Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"text-green-300",children:["Deals: ",e.jsx("span",{className:"font-semibold",children:s.performance.dealsProcessed})]}),e.jsxs("div",{className:"text-blue-300",children:["Success: ",e.jsxs("span",{className:"font-semibold",children:[s.performance.successRate,"%"]})]}),e.jsxs("div",{className:"text-red-300",children:["Errors: ",e.jsx("span",{className:"font-semibold",children:s.errorCount})]}),e.jsxs("div",{className:"text-yellow-300",children:["Conflicts: ",e.jsx("span",{className:"font-semibold",children:s.conflictCount})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{htmlFor:`enable-${s.botName}`,children:"Enabled"}),e.jsx(z,{id:`enable-${s.botName}`,checked:s.isEnabled,onCheckedChange:a=>Y(s.botName,a)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"Method"}),e.jsxs(C,{value:s.currentMethod,onValueChange:a=>_(s.botName,a),children:[e.jsx(T,{children:e.jsx(S,{})}),e.jsx(k,{children:s.methodsAvailable.map(a=>e.jsx(d,{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Affiliate Tags"}),e.jsxs(i,{size:"sm",variant:"outline",onClick:()=>N(s.botName),className:"h-6 px-2",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),"Add Tag"]})]}),e.jsxs("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:[(t=s.affiliateTags)==null?void 0:t.map(a=>e.jsx("div",{className:"bg-slate-800 text-white p-3 rounded border border-slate-600",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-slate-100",children:a.networkName}),e.jsx("div",{className:"text-xs text-slate-300 truncate",title:a.affiliateTag,children:a.affiliateTag.length>35?a.affiliateTag.substring(0,35)+"...":a.affiliateTag}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs(b,{variant:a.isActive?"default":"secondary",className:"text-xs bg-green-600 hover:bg-green-700 text-white",title:`Commission Rate: ${a.commissionRate}% - This is how much you earn from each sale through this affiliate network`,children:[e.jsx("i",{className:"fas fa-dollar-sign"})," ",a.commissionRate,"% Commission"]}),e.jsx(b,{variant:a.tagType==="wrapper"?"destructive":"outline",className:`text-xs ${a.tagType==="wrapper"?"bg-purple-600 text-white":a.tagType==="parameter"?"bg-blue-600 text-white":"bg-orange-600 text-white"}`,title:`Tag Type: ${a.tagType} - ${a.tagType==="wrapper"?"Wraps URLs in affiliate links":a.tagType==="parameter"?"Adds affiliate parameters to URLs":"Direct URL replacement"}`,children:a.tagType})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(z,{checked:a.isActive,onCheckedChange:()=>G(a),className:"scale-75"}),e.jsx(i,{size:"sm",variant:"ghost",onClick:()=>M(a),className:"h-6 w-6 p-0",children:e.jsx(ne,{className:"h-3 w-3"})}),e.jsx(i,{size:"sm",variant:"ghost",onClick:()=>W(a.id),className:"h-6 w-6 p-0 text-red-500 hover:text-red-700",children:e.jsx(ce,{className:"h-3 w-3"})})]})]})},a.id)),(!s.affiliateTags||s.affiliateTags.length===0)&&e.jsx("div",{className:"text-xs text-gray-500 text-center py-2",children:"No affiliate tags configured"})]}),F===s.botName&&e.jsxs("div",{className:"bg-slate-700 text-white p-4 rounded border border-slate-500 space-y-3",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-100",children:[e.jsx("i",{className:"fas fa-dollar-sign"})," Add New Affiliate Tag"]}),e.jsx("div",{className:"text-xs text-slate-300",children:"Commission rates: Amazon ~4%, CueLinks ~6.5%, EarnKaro ~4%, INRDeals ~3.5%"}),e.jsx(g,{placeholder:"Network Name (e.g., CueLinks, Amazon Associates)",value:l.networkName,onChange:a=>m({...l,networkName:a.target.value}),className:"h-9 text-sm bg-slate-600 border-slate-500 text-white placeholder-slate-300"}),e.jsx(g,{placeholder:"Affiliate Tag/URL (e.g., tag=your-id or https://link.com/?url={{URL}})",value:l.affiliateTag,onChange:a=>m({...l,affiliateTag:a.target.value}),className:"h-9 text-sm bg-slate-600 border-slate-500 text-white placeholder-slate-300"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(C,{value:l.tagType,onValueChange:a=>m({...l,tagType:a}),children:[e.jsx(T,{className:"h-9 text-sm bg-slate-600 border-slate-500 text-white",children:e.jsx(S,{placeholder:"Select tag type"})}),e.jsxs(k,{className:"bg-slate-700 border-slate-500",children:[e.jsx(d,{value:"parameter",className:"text-white hover:bg-slate-600",children:"Parameter (adds ?tag=id)"}),e.jsx(d,{value:"wrapper",className:"text-white hover:bg-slate-600",children:"Wrapper (wraps URL)"}),e.jsx(d,{value:"url",className:"text-white hover:bg-slate-600",children:"Direct URL"})]})]}),e.jsx(g,{type:"number",step:"0.1",placeholder:"Commission % (e.g., 4.0 for 4%)",value:l.commissionRate,onChange:a=>m({...l,commissionRate:parseFloat(a.target.value)||0}),className:"h-9 text-sm bg-slate-600 border-slate-500 text-white placeholder-slate-300"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{size:"sm",onClick:()=>K(s.botName),disabled:!l.networkName||!l.affiliateTag,className:"h-8 text-sm bg-green-600 hover:bg-green-700 text-white",children:[e.jsx("i",{className:"fas fa-dollar-sign"})," Add Affiliate Tag"]}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>{N(null),m({networkName:"",affiliateTag:"",tagType:"parameter",commissionRate:0})},className:"h-8 text-sm border-slate-500 text-slate-300 hover:bg-slate-600 hover:text-white",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(h,{children:[e.jsx("i",{className:"fas fa-dollar-sign"})," Commission Rate Method"]}),e.jsxs(i,{size:"sm",variant:"outline",onClick:()=>B(s.botName),className:"h-6 px-2",children:[e.jsx(E,{className:"h-3 w-3 mr-1"}),"Settings"]})]}),e.jsxs(C,{value:s.commissionRateMethod||"manual",onValueChange:a=>X(s.botName,a),children:[e.jsx(T,{className:"h-9 text-sm",children:e.jsx(S,{})}),e.jsxs(k,{children:[e.jsxs(d,{value:"manual",children:[e.jsx("i",{className:"fas fa-chart-bar"})," Manual/CSV Upload"]}),e.jsxs(d,{value:"scraping",children:[e.jsx("i",{className:"fas fa-robot"})," Auto-Scraping"]}),e.jsx(d,{value:"api",children:"ðŸ”Œ API Integration"}),e.jsxs(d,{value:"performance",children:[e.jsx("i",{className:"fas fa-chart-line"})," Performance-Based"]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.commissionRateMethod==="manual"&&'<i className="fas fa-chart-bar"></i> Upload CSV or manually set rates',s.commissionRateMethod==="scraping"&&'<i className="fas fa-robot"></i> Daily scraping of public commission pages',s.commissionRateMethod==="api"&&"ðŸ”Œ Real-time API rate lookup (requires setup)",s.commissionRateMethod==="performance"&&'<i className="fas fa-chart-line"></i> ML-based optimization using actual performance',!s.commissionRateMethod&&'<i className="fas fa-chart-bar"></i> Upload CSV or manually set rates']}),H===s.botName&&e.jsxs("div",{className:"bg-slate-700 text-white p-4 rounded border border-slate-500 space-y-3",children:[e.jsxs("div",{className:"text-sm font-medium text-slate-100",children:[e.jsx("i",{className:"fas fa-dollar-sign"})," Commission Rate Settings"]}),(s.commissionRateMethod==="manual"||!s.commissionRateMethod)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-slate-300",children:"Upload CSV with columns: Network, Category, Rate"}),e.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:a=>{var c;const n=(c=a.target.files)==null?void 0:c[0];n&&Q(s.botName,n)},className:"block w-full text-sm text-slate-300 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-slate-600 file:text-white hover:file:bg-slate-500"}),J===s.botName&&e.jsx("div",{className:"text-xs text-blue-300",children:"ðŸ“¤ Uploading commission rates..."})]}),s.commissionRateMethod==="scraping"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-slate-300",children:"Scraping frequency: Daily at 2 AM"}),e.jsx("div",{className:"text-xs text-slate-300",children:"Target sites: Amazon, CueLinks, EarnKaro"}),e.jsxs("div",{className:"text-xs text-green-300",children:[e.jsx("i",{className:"fas fa-check-circle"})," Last scrape: 6 hours ago (102 rates updated)"]})]}),s.commissionRateMethod==="api"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-slate-300",children:"API integration requires affiliate network API keys"}),e.jsxs("div",{className:"text-xs text-orange-300",children:[e.jsx("i",{className:"fas fa-exclamation-triangle"})," Setup required - contact affiliate networks for API access"]})]}),s.commissionRateMethod==="performance"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-slate-300",children:"ML optimization based on actual earnings data"}),e.jsxs("div",{className:"text-xs text-blue-300",children:[e.jsx("i",{className:"fas fa-chart-bar"})," Learning from ",s.performance.dealsProcessed," processed deals"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(i,{size:"sm",variant:"outline",onClick:()=>B(null),className:"h-7 text-xs border-slate-500 text-slate-300 hover:bg-slate-600 hover:text-white",children:"Close"})})]})]}),P===s.botName&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{children:"API Key"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{type:"password",placeholder:"Enter API key",value:f,onChange:a=>R(a.target.value)}),e.jsx(i,{size:"sm",onClick:()=>ee(s.botName),disabled:!f,children:"Enable"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{size:"sm",variant:"outline",onClick:()=>Z(s.botName),className:"flex-1",children:[e.jsx(A,{className:"h-3 w-3 mr-1"}),"Restart"]}),e.jsx(i,{size:"sm",variant:"outline",onClick:()=>V(P===s.botName?null:s.botName),children:e.jsx(E,{className:"h-3 w-3"})})]})]})]})]},s.botName)})}),e.jsxs(u,{children:[e.jsx(v,{children:e.jsx(y,{children:"8-Bot System Guide"})}),e.jsxs(w,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Simple Bots (Fixed Affiliate)"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Prime Picks:"})," Amazon Associates"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Cue Picks:"})," CueLinks"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Value Picks:"})," EarnKaro"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"DealsHub:"})," INRDeals"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Lootbox:"})," Deodap"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Smart Bots (Multi-Affiliate)"}),e.jsxs("ul",{className:"text-sm space-y-1",children:[e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Click Picks:"})," CPC Optimization"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Global Picks:"})," International"]}),e.jsxs("li",{children:["â€¢ ",e.jsx("strong",{children:"Travel Picks:"})," Travel Partners"]})]})]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-1",children:"Method Selection"}),e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:"Telegram:"})," Monitor Telegram channels (Primary) â€¢",e.jsx("strong",{children:"Scraping:"})," Web scraping fallback â€¢",e.jsx("strong",{children:"API:"})," Direct API integration (when available)"]})]})]})]})]})})};export{we as default};
